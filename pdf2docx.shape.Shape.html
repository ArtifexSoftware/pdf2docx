

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pdf2docx.shape.Shape module &mdash; pdf2docx 0.5.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pdf2docx.shape.Shapes module" href="pdf2docx.shape.Shapes.html" />
    <link rel="prev" title="pdf2docx.shape.Paths module" href="pdf2docx.shape.Paths.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pdf2docx
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pdf2docx.html">pdf2docx package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pdf2docx.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pdf2docx.common.html">pdf2docx.common package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pdf2docx.image.html">pdf2docx.image package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pdf2docx.page.html">pdf2docx.page package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="pdf2docx.shape.html">pdf2docx.shape package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pdf2docx.table.html">pdf2docx.table package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pdf2docx.text.html">pdf2docx.text package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pdf2docx.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pdf2docx.html#module-pdf2docx">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pdf2docx</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">API Documentation</a> &raquo;</li>
        
          <li><a href="pdf2docx.html">pdf2docx package</a> &raquo;</li>
        
          <li><a href="pdf2docx.shape.html">pdf2docx.shape package</a> &raquo;</li>
        
      <li>pdf2docx.shape.Shape module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/pdf2docx.shape.Shape.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pdf2docx.shape.Shape">
<span id="pdf2docx-shape-shape-module"></span><h1>pdf2docx.shape.Shape module<a class="headerlink" href="#module-pdf2docx.shape.Shape" title="Permalink to this headline">¶</a></h1>
<p>Objects representing PDF stroke and filling extracted from Path.</p>
<ul class="simple">
<li><p>Stroke: consider only the horizontal or vertical path segments</p></li>
<li><p>Fill  : bbox of closed path filling area</p></li>
</ul>
<p>Hyperlink in <code class="docutils literal notranslate"><span class="pre">PyMuPDF</span></code> is represented as uri and its rectangular area (hot-area), while the
applied text isn’t extracted explicitly. To reuse the process that identifying applied text of
text style shape (e.g. underline and highlight), hyperlink is also abstracted to be a <code class="docutils literal notranslate"><span class="pre">Shape</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The evident difference of hyperlink shape to text style shape is:
the <a class="reference internal" href="pdf2docx.common.share.html#pdf2docx.common.share.RectType" title="pdf2docx.common.share.RectType"><code class="xref py py-class docutils literal notranslate"><span class="pre">RectType</span></code></a> of hyperlink shape is determined in advance,
while text style shape needs to be identified by the position to associated text blocks.</p>
</div>
<p>Above all, the semantic meaning of shape instance may be:</p>
<ul class="simple">
<li><p>strike through line of text</p></li>
<li><p>under line of text</p></li>
<li><p>highlight area of text</p></li>
<li><p>table border</p></li>
<li><p>cell shading</p></li>
<li><p>hyperlink</p></li>
</ul>
<p>Data structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="s1">&#39;bbox&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
    <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">srgb_value</span><span class="p">,</span>

    <span class="c1"># for Stroke</span>
    <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
    <span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
    <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>

    <span class="c1"># for Hyperlink</span>
    <span class="s1">&#39;uri&#39;</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="py class">
<dt id="pdf2docx.shape.Shape.Fill">
<em class="property">class </em><code class="sig-prename descclassname">pdf2docx.shape.Shape.</code><code class="sig-name descname">Fill</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">raw</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pdf2docx.shape.Shape.Shape" title="pdf2docx.shape.Shape.Shape"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdf2docx.shape.Shape.Shape</span></code></a></p>
<p>Rectangular (bbox) filling area of a closed path.
The semantic meaning may be table shading, or text style like highlight.</p>
<dl class="py method">
<dt id="pdf2docx.shape.Shape.Fill.to_stroke">
<code class="sig-name descname">to_stroke</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_border_width</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Fill.to_stroke" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to Stroke instance based on width criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_border_width</strong> (<em>float</em>) – Stroke width must less than this value.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Stroke instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pdf2docx.shape.Shape.Stroke" title="pdf2docx.shape.Shape.Stroke">Stroke</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Fill from shape point of view may be a Stroke from content point of view.
The criterion here is whether the width is smaller than defined <code class="docutils literal notranslate"><span class="pre">max_border_width</span></code>.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pdf2docx.shape.Shape.Hyperlink">
<em class="property">class </em><code class="sig-prename descclassname">pdf2docx.shape.Shape.</code><code class="sig-name descname">Hyperlink</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">raw</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Hyperlink" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pdf2docx.shape.Shape.Shape" title="pdf2docx.shape.Shape.Shape"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdf2docx.shape.Shape.Shape</span></code></a></p>
<p>Rectangular area, i.e. <code class="docutils literal notranslate"><span class="pre">hot</span> <span class="pre">area</span></code> for a hyperlink.</p>
<p>Hyperlink in <code class="docutils literal notranslate"><span class="pre">PyMuPDF</span></code> is represented as uri and its hot area, while the applied text isn’t extracted
explicitly. To reuse the process that identifying applied text of text style shape (e.g. underline and
highlight), hyperlink is also abstracted to be a <code class="docutils literal notranslate"><span class="pre">Shape</span></code>.</p>
<dl class="py method">
<dt id="pdf2docx.shape.Shape.Hyperlink.semantic_type">
<code class="sig-name descname">semantic_type</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">blocks</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>list<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Hyperlink.semantic_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Semantic type of Hyperlink shape is determined, i.e. <code class="docutils literal notranslate"><span class="pre">RectType.HYPERLINK</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.shape.Shape.Hyperlink.store">
<code class="sig-name descname">store</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Hyperlink.store" title="Permalink to this definition">¶</a></dt>
<dd><p>Store properties in raw dict.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pdf2docx.shape.Shape.Shape">
<em class="property">class </em><code class="sig-prename descclassname">pdf2docx.shape.Shape.</code><code class="sig-name descname">Shape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">raw</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pdf2docx.common.Element.html#pdf2docx.common.Element.Element" title="pdf2docx.common.Element.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdf2docx.common.Element.Element</span></code></a></p>
<p>Shape object.</p>
<dl class="py method">
<dt id="pdf2docx.shape.Shape.Shape.is_determined">
<em class="property">property </em><code class="sig-name descname">is_determined</code><a class="headerlink" href="#pdf2docx.shape.Shape.Shape.is_determined" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pdf2docx.shape.Shape.Shape.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">page</span></em>, <em class="sig-param"><span class="n">color</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Shape.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot rectangle shapes with <code class="docutils literal notranslate"><span class="pre">PyMuPDF</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.shape.Shape.Shape.semantic_type">
<code class="sig-name descname">semantic_type</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">blocks</span><span class="p">:</span> <span class="n">list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Shape.semantic_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Determin semantic type based on the position to text blocks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>blocks</strong> (<em>list</em>) – A list of <code class="docutils literal notranslate"><span class="pre">TextBlock</span></code> instance.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Shape type.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="pdf2docx.common.share.html#pdf2docx.common.share.RectType" title="pdf2docx.common.share.RectType">RectType</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.shape.Shape.Shape.store">
<code class="sig-name descname">store</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Shape.store" title="Permalink to this definition">¶</a></dt>
<dd><p>Store properties in raw dict.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pdf2docx.shape.Shape.Stroke">
<em class="property">class </em><code class="sig-prename descclassname">pdf2docx.shape.Shape.</code><code class="sig-name descname">Stroke</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">raw</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Stroke" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pdf2docx.shape.Shape.Shape" title="pdf2docx.shape.Shape.Shape"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdf2docx.shape.Shape.Shape</span></code></a></p>
<p>Horizontal or vertical stroke of a path.
The semantic meaning may be table border, or text style line like underline and strike-through.</p>
<dl class="py method">
<dt id="pdf2docx.shape.Shape.Stroke.horizontal">
<em class="property">property </em><code class="sig-name descname">horizontal</code><a class="headerlink" href="#pdf2docx.shape.Shape.Stroke.horizontal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pdf2docx.shape.Shape.Stroke.store">
<code class="sig-name descname">store</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Stroke.store" title="Permalink to this definition">¶</a></dt>
<dd><p>Store properties in raw dict.</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.shape.Shape.Stroke.update_bbox">
<code class="sig-name descname">update_bbox</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rect</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.shape.Shape.Stroke.update_bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Update stroke bbox (related to real page CS).</p>
<ul class="simple">
<li><p>Update start/end points if <code class="docutils literal notranslate"><span class="pre">rect.area==0</span></code>.</p></li>
<li><p>Ppdate bbox directly if <code class="docutils literal notranslate"><span class="pre">rect.area!=0</span></code>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rect</strong> (<em>fitz.Rect</em><em>, </em><em>tuple</em>) – <code class="docutils literal notranslate"><span class="pre">(x0,</span> <span class="pre">y0,</span> <span class="pre">x1,</span> <span class="pre">y1)</span></code> like data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>self</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pdf2docx.shape.Shape.Stroke" title="pdf2docx.shape.Shape.Stroke">Stroke</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.shape.Shape.Stroke.vertical">
<em class="property">property </em><code class="sig-name descname">vertical</code><a class="headerlink" href="#pdf2docx.shape.Shape.Stroke.vertical" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pdf2docx.shape.Shape.Stroke.x0">
<em class="property">property </em><code class="sig-name descname">x0</code><a class="headerlink" href="#pdf2docx.shape.Shape.Stroke.x0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pdf2docx.shape.Shape.Stroke.x1">
<em class="property">property </em><code class="sig-name descname">x1</code><a class="headerlink" href="#pdf2docx.shape.Shape.Stroke.x1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pdf2docx.shape.Shape.Stroke.y0">
<em class="property">property </em><code class="sig-name descname">y0</code><a class="headerlink" href="#pdf2docx.shape.Shape.Stroke.y0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pdf2docx.shape.Shape.Stroke.y1">
<em class="property">property </em><code class="sig-name descname">y1</code><a class="headerlink" href="#pdf2docx.shape.Shape.Stroke.y1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="pdf2docx.shape.Shapes.html" class="btn btn-neutral float-right" title="pdf2docx.shape.Shapes module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="pdf2docx.shape.Paths.html" class="btn btn-neutral float-left" title="pdf2docx.shape.Paths module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, dothinking.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>