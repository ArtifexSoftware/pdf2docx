<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pdf2docx.font.Fonts module &mdash; pdf2docx refs/heads/master documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=03c5a516"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pdf2docx
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">USER GUIDE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="techdoc.html">Technical Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API DOCUMENTATION</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">pdf2docx</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pdf2docx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pdf2docx.font.Fonts module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pdf2docx.font.Fonts.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pdf2docx.font.Fonts">
<span id="pdf2docx-font-fonts-module"></span><h1>pdf2docx.font.Fonts module<a class="headerlink" href="#module-pdf2docx.font.Fonts" title="Link to this heading"></a></h1>
<p>Extract fonts properties from PDF.</p>
<p>Font properties like font name, size are covered in <a class="reference internal" href="pdf2docx.text.TextSpan.html#module-pdf2docx.text.TextSpan" title="pdf2docx.text.TextSpan"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextSpan</span></code></a>, 
but more generic properties are required further:</p>
<ul>
<li><p>Font family name. The font name extracted and set in <code class="docutils literal notranslate"><span class="pre">TextSpan</span></code> might not valid when 
directly used in MS Word, e.g. “ArialMT” should be “Arial”. So, we need to get font
family name, which should be accepted by MS Word, based on the font file itself.</p></li>
<li><p>Font line height ratio. As line height = font_size * line_height_ratio, it’s used to 
calculate relative line spacing. In general, 1.12 is an approximate value to this ratio,
but it’s in fact a font-related value, especially for CJK font.</p>
<blockquote>
<div><ul class="simple">
<li><p>So, extract font metrics, e.g. ascender and descender, with third party library <code class="docutils literal notranslate"><span class="pre">fontTools</span></code>
in first priority. This can obtain an accurate line height ratio, but sometimes the 
embedded font data might crash.</p></li>
<li><p>Then, we have to use the default properties, i.e. ascender and descender, extracted by
<code class="docutils literal notranslate"><span class="pre">PyMuPDF</span></code> directly, but this value isn’t so accurate.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="pdf2docx.font.Fonts.Font">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pdf2docx.font.Fonts.</span></span><span class="sig-name descname"><span class="pre">Font</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">descriptor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_height</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.font.Fonts.Font" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pdf2docx.font.Fonts.Font.descriptor">
<span class="sig-name descname"><span class="pre">descriptor</span></span><a class="headerlink" href="#pdf2docx.font.Fonts.Font.descriptor" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdf2docx.font.Fonts.Font.line_height">
<span class="sig-name descname"><span class="pre">line_height</span></span><a class="headerlink" href="#pdf2docx.font.Fonts.Font.line_height" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdf2docx.font.Fonts.Font.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#pdf2docx.font.Fonts.Font.name" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pdf2docx.font.Fonts.Fonts">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pdf2docx.font.Fonts.</span></span><span class="sig-name descname"><span class="pre">Fonts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.font.Fonts.Fonts" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="pdf2docx.common.Collection.html#pdf2docx.common.Collection.BaseCollection" title="pdf2docx.common.Collection.BaseCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCollection</span></code></a></p>
<p>Extracted fonts properties from PDF.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pdf2docx.font.Fonts.Fonts.extract">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitz_doc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.font.Fonts.Fonts.extract" title="Link to this definition"></a></dt>
<dd><p>Extract fonts from PDF and get properties.
* Only embedded fonts (v.s. the base 14 fonts) can be extracted.
* The extracted fonts may be invalid due to reason from PDF file itself.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdf2docx.font.Fonts.Fonts.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">font_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.font.Fonts.Fonts.get" title="Link to this definition"></a></dt>
<dd><p>Get matched font by font name, or return None.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdf2docx.font.Fonts.Fonts.get_font_family_name">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_font_family_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_font</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TTFont</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.font.Fonts.Fonts.get_font_family_name" title="Link to this definition"></a></dt>
<dd><p>Get the font family name from the font’s names table.</p>
<p><a class="reference external" href="https://gist.github.com/pklaus/dce37521579513c574d0">https://gist.github.com/pklaus/dce37521579513c574d0</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdf2docx.font.Fonts.Fonts.get_line_height_factor">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_line_height_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_font</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TTFont</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.font.Fonts.Fonts.get_line_height_factor" title="Link to this definition"></a></dt>
<dd><p>Calculate line height ratio based on <code class="docutils literal notranslate"><span class="pre">hhea</span></code> and <code class="docutils literal notranslate"><span class="pre">OS/2</span></code> tables.</p>
<p>Fon non-CJK fonts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">hhea</span><span class="o">.</span><span class="n">Ascent</span> <span class="o">-</span> <span class="n">hhea</span><span class="o">.</span><span class="n">Descent</span> <span class="o">+</span> <span class="n">hhea</span><span class="o">.</span><span class="n">LineGap</span><span class="p">)</span> <span class="o">/</span> <span class="n">units_per_em</span>
</pre></div>
</div>
<p>For non-CJK fonts (Windows):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">OS</span><span class="o">/</span><span class="mf">2.</span><span class="n">winAscent</span> <span class="o">+</span> <span class="n">OS</span><span class="o">/</span><span class="mf">2.</span><span class="n">winDescent</span> <span class="o">+</span> <span class="p">[</span><span class="n">External</span> <span class="n">Leading</span><span class="p">])</span> <span class="o">/</span> <span class="n">units_per_em</span>
<span class="n">External</span> <span class="n">Leading</span> <span class="o">=</span> <span class="n">MAX</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hhea</span><span class="o">.</span><span class="n">LineGap</span> <span class="o">-</span> <span class="p">((</span><span class="n">OS</span><span class="o">/</span><span class="mf">2.</span><span class="n">WinAscent</span> <span class="o">+</span> <span class="n">OS</span><span class="o">/</span><span class="mf">2.</span><span class="n">winDescent</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">hhea</span><span class="o">.</span><span class="n">Ascent</span> <span class="o">-</span> <span class="n">hhea</span><span class="o">.</span><span class="n">Descent</span><span class="p">)))</span>
</pre></div>
</div>
<p>For CJK fonts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="mf">1.3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hhea</span><span class="o">.</span><span class="n">Ascent</span> <span class="o">-</span> <span class="n">hhea</span><span class="o">.</span><span class="n">Descent</span><span class="p">)</span> <span class="o">/</span> <span class="n">units_per_em</span>
</pre></div>
</div>
<p>Read more:
* <a class="reference external" href="https://docs.microsoft.com/en-us/typography/opentype/spec/recom#baseline-to-baseline-distances">https://docs.microsoft.com/en-us/typography/opentype/spec/recom#baseline-to-baseline-distances</a>
* <a class="reference external" href="https://github.com/source-foundry/font-line#baseline-to-baseline-distance-calculations">https://github.com/source-foundry/font-line#baseline-to-baseline-distance-calculations</a>
* <a class="reference external" href="https://www.zhihu.com/question/23349103">https://www.zhihu.com/question/23349103</a>
* <a class="reference external" href="https://github.com/source-foundry/font-line/blob/master/lib/fontline/metrics.py">https://github.com/source-foundry/font-line/blob/master/lib/fontline/metrics.py</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdf2docx.font.Fonts.Fonts.is_cjk_font">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_cjk_font</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_font</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TTFont</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.font.Fonts.Fonts.is_cjk_font" title="Link to this definition"></a></dt>
<dd><p>Test font object to confirm that it meets our definition of a CJK font file.</p>
<p>The definition is met if any of the following conditions are True:
1. The font has a CJK code page bit set in the OS/2 table
2. The font has a CJK Unicode range bit set in the OS/2 table
3. The font has any CJK Unicode code points defined in the cmap table</p>
<p><a class="reference external" href="https://github.com/googlefonts/fontbakery/blob/main/Lib/fontbakery/profiles/shared_conditions.py">https://github.com/googlefonts/fontbakery/blob/main/Lib/fontbakery/profiles/shared_conditions.py</a></p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Artifex.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>