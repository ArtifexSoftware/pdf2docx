

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pdf2docx.text.TextBlock module &mdash; pdf2docx 0.5.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pdf2docx.text.TextSpan module" href="pdf2docx.text.TextSpan.html" />
    <link rel="prev" title="pdf2docx.text.Spans module" href="pdf2docx.text.Spans.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pdf2docx
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pdf2docx</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pdf2docx.html">pdf2docx package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pdf2docx.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pdf2docx.common.html">pdf2docx.common package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pdf2docx.image.html">pdf2docx.image package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pdf2docx.page.html">pdf2docx.page package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pdf2docx.shape.html">pdf2docx.shape package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pdf2docx.table.html">pdf2docx.table package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="pdf2docx.text.html">pdf2docx.text package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pdf2docx.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pdf2docx.html#module-pdf2docx">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pdf2docx</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">pdf2docx</a> &raquo;</li>
        
          <li><a href="pdf2docx.html">pdf2docx package</a> &raquo;</li>
        
          <li><a href="pdf2docx.text.html">pdf2docx.text package</a> &raquo;</li>
        
      <li>pdf2docx.text.TextBlock module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/pdf2docx.text.TextBlock.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pdf2docx.text.TextBlock">
<span id="pdf2docx-text-textblock-module"></span><h1>pdf2docx.text.TextBlock module<a class="headerlink" href="#module-pdf2docx.text.TextBlock" title="Permalink to this headline">¶</a></h1>
<p>Text block objects based on PDF raw dict extracted with PyMuPDF.</p>
<p>&#64;created: 2020-07-22</p>
<p>—
<a class="reference external" href="https://pymupdf.readthedocs.io/en/latest/textpage.html">https://pymupdf.readthedocs.io/en/latest/textpage.html</a></p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p># raw dict
# ——————————–
‘type’: 0,
‘bbox’: (x0,y0,x1,y1),
‘lines’: [ lines ]</p>
<p># introduced dict
# ——————————–
‘before_space’: bs,
‘after_space’: as,
‘line_space’: ls,</p>
<p>‘alignment’: 0,
‘left_space’: 10.0,
‘right_space’: 0.0,</p>
<p>‘tab_stops’: [15.4, 35.0]</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<dl class="py class">
<dt id="pdf2docx.text.TextBlock.TextBlock">
<em class="property">class </em><code class="sig-prename descclassname">pdf2docx.text.TextBlock.</code><code class="sig-name descname">TextBlock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">raw</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pdf2docx.common.Block.html#pdf2docx.common.Block.Block" title="pdf2docx.common.Block.Block"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdf2docx.common.Block.Block</span></code></a></p>
<p>Text block.</p>
<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line_or_lines</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add line or lines to TextBlock.</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.is_flow_layout">
<code class="sig-name descname">is_flow_layout</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">float_layout_tolerance</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">line_separate_threshold</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.is_flow_layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if flow layout: same bottom-left point for lines in same row.</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.make_docx">
<code class="sig-name descname">make_docx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.make_docx" title="Permalink to this definition">¶</a></dt>
<dd><p>Create paragraph for a text block.
—
:param - p: docx paragraph instance</p>
<p>NOTE:
- the left position of paragraph set by paragraph indent, rather than TAB stop
- hard line break is used for line in block.</p>
<p>Generally, a pdf block is a docx paragraph, with block-&gt;line as line in paragraph.
But without the context, it’s not able to recognize a block line as word wrap, or a
separate line instead. A rough rule used here: block line will be treated as separate
line, except this line and next line are indeed in the same line.</p>
<p>Refer to python-docx doc for details on text format:
- <a class="reference external" href="https://python-docx.readthedocs.io/en/latest/user/text.html">https://python-docx.readthedocs.io/en/latest/user/text.html</a>
- <a class="reference external" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdAlignParagraph.html#wdparagraphalignment">https://python-docx.readthedocs.io/en/latest/api/enum/WdAlignParagraph.html#wdparagraphalignment</a></p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.parse_horizontal_spacing">
<code class="sig-name descname">parse_horizontal_spacing</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bbox</span></em>, <em class="sig-param"><span class="n">line_separate_threshold</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">line_free_space_ratio_threshold</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">lines_left_aligned_threshold</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">lines_right_aligned_threshold</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">lines_center_aligned_threshold</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.parse_horizontal_spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>Set horizontal spacing based on lines layout and page bbox.
- The general spacing is determined by paragraph alignment and indentation.
- The detailed spacing of block lines is determined by tab stops.</p>
<p>Multiple alignment modes may exist in block (due to improper organized lines
from PyMuPDF), e.g. some lines align left, and others right. In this case,
LEFT alignment is set, and use TAB to position each line.</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.parse_line_spacing">
<code class="sig-name descname">parse_line_spacing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.parse_line_spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate average line spacing.</p>
<p>The layout of pdf text block: line-space-line-space-line, excepting space before first line,
i.e. space-line-space-line, when creating paragraph in docx. So, an average line height = space+line.</p>
<p>Then, the height of first line can be adjusted by updating paragraph before-spacing.</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.parse_text_format">
<code class="sig-name descname">parse_text_format</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rects</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.parse_text_format" title="Permalink to this definition">¶</a></dt>
<dd><p>parse text format with style represented by rectangles.
—
Args:
- rects: Shapes, potential styles applied on blocks</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">page</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot block/line/span area, in PDF page.
—</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>page: fitz.Page object</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.split">
<code class="sig-name descname">split</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split contained lines vertically and create associated text blocks.</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.store">
<code class="sig-name descname">store</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.store" title="Permalink to this definition">¶</a></dt>
<dd><p>Store attributes in json format.</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.strip">
<code class="sig-name descname">strip</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>strip each Line instance.</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.text">
<em class="property">property </em><code class="sig-name descname">text</code><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.text" title="Permalink to this definition">¶</a></dt>
<dd><p>Get text content in block, joning each line with `
<a href="#id1"><span class="problematic" id="id2">`</span></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="pdf2docx.text.TextBlock.TextBlock.text_direction">
<em class="property">property </em><code class="sig-name descname">text_direction</code><a class="headerlink" href="#pdf2docx.text.TextBlock.TextBlock.text_direction" title="Permalink to this definition">¶</a></dt>
<dd><p>All lines contained in text block must have same text direction. Otherwise, set normal direction</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="pdf2docx.text.TextSpan.html" class="btn btn-neutral float-right" title="pdf2docx.text.TextSpan module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="pdf2docx.text.Spans.html" class="btn btn-neutral float-left" title="pdf2docx.text.Spans module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, dothinking.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>